Finish writing ALL tests

Read about and update to CompletableFuture for retry
